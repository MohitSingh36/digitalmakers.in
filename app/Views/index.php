<?php
    $countries_data = [
        [
            "country" => "India",
            "name" => "IN",
            "calling_code" => "+91",
        ],
        [
            "country" => "Afghanistan",
            "name" => "AF",
            "calling_code" => "+93",
        ],
        [
            "country" => "Albania",
            "name" => "AL",
            "calling_code" => "+355",
        ],
        [
            "country" => "Algeria",
            "name" => "DZ",
            "calling_code" => "+213",
        ],
        [
            "country" => "Andorra",
            "name" => "AD",
            "calling_code" => "+376",
        ],
        [
            "country" => "Angola",
            "name" => "AO",
            "calling_code" => "+244",
        ],
        [
            "country" => "Antigua and Barbuda",
            "name" => "AG",
            "calling_code" => "+1-268",
        ],
        [
            "country" => "Argentina",
            "name" => "AR",
            "calling_code" => "+54",
        ],
        [
            "country" => "Armenia",
            "name" => "AM",
            "calling_code" => "+374",
        ],
        [
            "country" => "Australia",
            "name" => "AU",
            "calling_code" => "+61",
        ],
        [
            "country" => "Austria",
            "name" => "AT",
            "calling_code" => "+43",
        ],
        [
            "country" => "Azerbaijan",
            "name" => "AZ",
            "calling_code" => "+994",
        ],
        [
            "country" => "Bahamas",
            "name" => "BS",
            "calling_code" => "+1",
        ],
        [
            "country" => "Bahrain",
            "name" => "BH",
            "calling_code" => "+973",
        ],
        [
            "country" => "Bangladesh",
            "name" => "BD",
            "calling_code" => "+880",
        ],
        [
            "country" => "Barbados",
            "name" => "BB",
            "calling_code" => "+1",
        ],
        [
            "country" => "Belarus",
            "name" => "BY",
            "calling_code" => "+375",
        ],
        [
            "country" => "Belgium",
            "name" => "BE",
            "calling_code" => "+32",
        ],
        [
            "country" => "Belize",
            "name" => "BZ",
            "calling_code" => "+501",
        ],
        [
            "country" => "Benin",
            "name" => "BJ",
            "calling_code" => "+229",
        ],
        [
            "country" => "Bhutan",
            "name" => "BT",
            "calling_code" => "+975",
        ],
        [
            "country" => "Bolivia",
            "name" => "BO",
            "calling_code" => "+591",
        ],
        [
            "country" => "Bosnia and Herzegovina",
            "name" => "BA",
            "calling_code" => "+387",
        ],
        [
            "country" => "Botswana",
            "name" => "BW",
            "calling_code" => "+267",
        ],
        [
            "country" => "Brazil",
            "name" => "BR",
            "calling_code" => "+55",
        ],
        [
            "country" => "Brunei",
            "name" => "BN",
            "calling_code" => "+673",
        ],
        [
            "country" => "Bulgaria",
            "name" => "BG",
            "calling_code" => "+359",
        ],
        [
            "country" => "Burkina Faso",
            "name" => "BF",
            "calling_code" => "+226",
        ],
        [
            "country" => "Burundi",
            "name" => "BI",
            "calling_code" => "+257",
        ],
        [
            "country" => "Cabo Verde",
            "name" => "CV",
            "calling_code" => "+238",
        ],
        [
            "country" => "Cambodia",
            "name" => "KH",
            "calling_code" => "+855",
        ],
        [
            "country" => "Cameroon",
            "name" => "CM",
            "calling_code" => "+237",
        ],
        [
            "country" => "Canada",
            "name" => "CA",
            "calling_code" => "+1",
        ],
        [
            "country" => "Central African Republic",
            "name" => "CF",
            "calling_code" => "+236",
        ],
        [
            "country" => "Chad",
            "name" => "TD",
            "calling_code" => "+235",
        ],
        [
            "country" => "Chile",
            "name" => "CL",
            "calling_code" => "+56",
        ],
        [
            "country" => "China",
            "name" => "CN",
            "calling_code" => "+86",
        ],
        [
            "country" => "Colombia",
            "name" => "CO",
            "calling_code" => "+57",
        ],
        [
            "country" => "Comoros",
            "name" => "KM",
            "calling_code" => "+269",
        ],
        [
            "country" => "Congo",
            "name" => "CG",
            "calling_code" => "+242",
        ],
        [
            "country" => "Costa Rica",
            "name" => "CR",
            "calling_code" => "+506",
        ],
        [
            "country" => "Croatia",
            "name" => "HR",
            "calling_code" => "+385",
        ],
        [
            "country" => "Cuba",
            "name" => "CU",
            "calling_code" => "+53",
        ],
        [
            "country" => "Cyprus",
            "name" => "CY",
            "calling_code" => "+357",
        ],
        [
            "country" => "Czech Republic",
            "name" => "CZ",
            "calling_code" => "+420",
        ],
        [
            "country" => "Denmark",
            "name" => "DK",
            "calling_code" => "+45",
        ],
        [
            "country" => "Djibouti",
            "name" => "DJ",
            "calling_code" => "+253",
        ],
        [
            "country" => "Dominica",
            "name" => "DM",
            "calling_code" => "+1",
        ],
        [
            "country" => "Dominican Republic",
            "name" => "DO",
            "calling_code" => "+1",
        ],
        [
            "country" => "Ecuador",
            "name" => "EC",
            "calling_code" => "+593",
        ],
        [
            "country" => "Egypt",
            "name" => "EG",
            "calling_code" => "+20",
        ],
        [
            "country" => "El Salvador",
            "name" => "SV",
            "calling_code" => "+503",
        ],
        [
            "country" => "Equatorial Guinea",
            "name" => "GQ",
            "calling_code" => "+240",
        ],
        [
            "country" => "Eritrea",
            "name" => "ER",
            "calling_code" => "+291",
        ],
        [
            "country" => "Estonia",
            "name" => "EE",
            "calling_code" => "+372",
        ],
        [
            "country" => "Eswatini",
            "name" => "SZ",
            "calling_code" => "+268",
        ],
        [
            "country" => "Ethiopia",
            "name" => "ET",
            "calling_code" => "+251",
        ],
        [
            "country" => "Fiji",
            "name" => "FJ",
            "calling_code" => "+679",
        ],
        [
            "country" => "Finland",
            "name" => "FI",
            "calling_code" => "+358",
        ],
        [
            "country" => "France",
            "name" => "FR",
            "calling_code" => "+33",
        ],
        [
            "country" => "Gabon",
            "name" => "GA",
            "calling_code" => "+241",
        ],
        [
            "country" => "Gambia",
            "name" => "GM",
            "calling_code" => "+220",
        ],
        [
            "country" => "Georgia",
            "name" => "GE",
            "calling_code" => "+995",
        ],
        [
            "country" => "Germany",
            "name" => "DE",
            "calling_code" => "+49",
        ],
        [
            "country" => "Ghana",
            "name" => "GH",
            "calling_code" => "+233",
        ],
        [
            "country" => "Greece",
            "name" => "GR",
            "calling_code" => "+30",
        ],
        [
            "country" => "Grenada",
            "name" => "GD",
            "calling_code" => "+1",
        ],
        [
            "country" => "Guatemala",
            "name" => "GT",
            "calling_code" => "+502",
        ],
        [
            "country" => "Guinea",
            "name" => "GN",
            "calling_code" => "+224",
        ],
        [
            "country" => "Guinea-Bissau",
            "name" => "GW",
            "calling_code" => "+245",
        ],
        [
            "country" => "Guyana",
            "name" => "GY",
            "calling_code" => "+592",
        ],
        [
            "country" => "Haiti",
            "name" => "HT",
            "calling_code" => "+509",
        ],
        [
            "country" => "Honduras",
            "name" => "HN",
            "calling_code" => "+504",
        ],
        [
            "country" => "Hungary",
            "name" => "HU",
            "calling_code" => "+36",
        ],
        [
            "country" => "Iceland",
            "name" => "IS",
            "calling_code" => "+354",
        ],
        [
            "country" => "Indonesia",
            "name" => "ID",
            "calling_code" => "+62",
        ],
        [
            "country" => "Iran",
            "name" => "IR",
            "calling_code" => "+98",
        ],
        [
            "country" => "Iraq",
            "name" => "IQ",
            "calling_code" => "+964",
        ],
        [
            "country" => "Ireland",
            "name" => "IE",
            "calling_code" => "+353",
        ],
        [
            "country" => "Israel",
            "name" => "IL",
            "calling_code" => "+972",
        ],
        [
            "country" => "Italy",
            "name" => "IT",
            "calling_code" => "+39",
        ],
        [
            "country" => "Jamaica",
            "name" => "JM",
            "calling_code" => "+1",
        ],
        [
            "country" => "Japan",
            "name" => "JP",
            "calling_code" => "+81",
        ],
        [
            "country" => "Jordan",
            "name" => "JO",
            "calling_code" => "+962",
        ],
        [
            "country" => "Kazakhstan",
            "name" => "KZ",
            "calling_code" => "+7",
        ],
        [
            "country" => "Kenya",
            "name" => "KE",
            "calling_code" => "+254",
        ],
        [
            "country" => "Kiribati",
            "name" => "KI",
            "calling_code" => "+686",
        ],
        [
            "country" => "Korea, North",
            "name" => "KP",
            "calling_code" => "+850",
        ],
        [
            "country" => "Korea, South",
            "name" => "KR",
            "calling_code" => "+82",
        ],
        [
            "country" => "Kosovo",
            "name" => "XK",
            "calling_code" => "+383",
        ],
        [
            "country" => "Kuwait",
            "name" => "KW",
            "calling_code" => "+965",
        ],
        [
            "country" => "Kyrgyzstan",
            "name" => "KG",
            "calling_code" => "+996",
        ],
        [
            "country" => "Laos",
            "name" => "LA",
            "calling_code" => "+856",
        ],
        [
            "country" => "Latvia",
            "name" => "LV",
            "calling_code" => "+371",
        ],
        [
            "country" => "Lebanon",
            "name" => "LB",
            "calling_code" => "+961",
        ],
        [
            "country" => "Lesotho",
            "name" => "LS",
            "calling_code" => "+266",
        ],
        [
            "country" => "Liberia",
            "name" => "LR",
            "calling_code" => "+231",
        ],
        [
            "country" => "Libya",
            "name" => "LY",
            "calling_code" => "+218",
        ],
        [
            "country" => "Liechtenstein",
            "name" => "LI",
            "calling_code" => "+423",
        ],
        [
            "country" => "Lithuania",
            "name" => "LT",
            "calling_code" => "+370",
        ],
        [
            "country" => "Luxembourg",
            "name" => "LU",
            "calling_code" => "+352",
        ],
        [
            "country" => "Madagascar",
            "name" => "MG",
            "calling_code" => "+261",
        ],
        [
            "country" => "Malawi",
            "name" => "MW",
            "calling_code" => "+265",
        ],
        [
            "country" => "Malaysia",
            "name" => "MY",
            "calling_code" => "+60",
        ],
        [
            "country" => "Maldives",
            "name" => "MV",
            "calling_code" => "+960",
        ],
        [
            "country" => "Mali",
            "name" => "ML",
            "calling_code" => "+223",
        ],
        [
            "country" => "Malta",
            "name" => "MT",
            "calling_code" => "+356",
        ],
        [
            "country" => "Marshall Islands",
            "name" => "MH",
            "calling_code" => "+692",
        ],
        [
            "country" => "Mauritania",
            "name" => "MR",
            "calling_code" => "+222",
        ],
        [
            "country" => "Mauritius",
            "name" => "MU",
            "calling_code" => "+230",
        ],
        [
            "country" => "Mexico",
            "name" => "MX",
            "calling_code" => "+52",
        ],
        [
            "country" => "Micronesia",
            "name" => "FM",
            "calling_code" => "+691",
        ],
        [
            "country" => "Moldova",
            "name" => "MD",
            "calling_code" => "+373",
        ],
        [
            "country" => "Monaco",
            "name" => "MC",
            "calling_code" => "+377",
        ],
        [
            "country" => "Mongolia",
            "name" => "MN",
            "calling_code" => "+976",
        ],
        [
            "country" => "Montenegro",
            "name" => "ME",
            "calling_code" => "+382",
        ],
        [
            "country" => "Morocco",
            "name" => "MA",
            "calling_code" => "+212",
        ],
        [
            "country" => "Mozambique",
            "name" => "MZ",
            "calling_code" => "+258",
        ],
        [
            "country" => "Myanmar",
            "name" => "MM",
            "calling_code" => "+95",
        ],
        [
            "country" => "Namibia",
            "name" => "NA",
            "calling_code" => "+264",
        ],
        [
            "country" => "Nauru",
            "name" => "NR",
            "calling_code" => "+674",
        ],
        [
            "country" => "Nepal",
            "name" => "NP",
            "calling_code" => "+977",
        ],
        [
            "country" => "Netherlands",
            "name" => "NL",
            "calling_code" => "+31",
        ],
        [
            "country" => "New Zealand",
            "name" => "NZ",
            "calling_code" => "+64",
        ],
        [
            "country" => "Nicaragua",
            "name" => "NI",
            "calling_code" => "+505",
        ],
        [
            "country" => "Niger",
            "name" => "NE",
            "calling_code" => "+227",
        ],
        [
            "country" => "Nigeria",
            "name" => "NG",
            "calling_code" => "+234",
        ],
        [
            "country" => "North Macedonia",
            "name" => "MK",
            "calling_code" => "+389",
        ],
        [
            "country" => "Norway",
            "name" => "NO",
            "calling_code" => "+47",
        ],
        [
            "country" => "Oman",
            "name" => "OM",
            "calling_code" => "+968",
        ],
        [
            "country" => "Pakistan",
            "name" => "PK",
            "calling_code" => "+92",
        ],
        [
            "country" => "Palau",
            "name" => "PW",
            "calling_code" => "+680",
        ],
        [
            "country" => "Palestine",
            "name" => "PS",
            "calling_code" => "+970",
        ],
        [
            "country" => "Panama",
            "name" => "PA",
            "calling_code" => "+507",
        ],
        [
            "country" => "Papua New Guinea",
            "name" => "PG",
            "calling_code" => "+675",
        ],
        [
            "country" => "Paraguay",
            "name" => "PY",
            "calling_code" => "+595",
        ],
        [
            "country" => "Peru",
            "name" => "PE",
            "calling_code" => "+51",
        ],
        [
            "country" => "Philippines",
            "name" => "PH",
            "calling_code" => "+63",
        ],
        [
            "country" => "Poland",
            "name" => "PL",
            "calling_code" => "+48",
        ],
        [
            "country" => "Portugal",
            "name" => "PT",
            "calling_code" => "+351",
        ],
        [
            "country" => "Qatar",
            "name" => "QA",
            "calling_code" => "+974",
        ],
        [
            "country" => "Romania",
            "name" => "RO",
            "calling_code" => "+40",
        ],
        [
            "country" => "Russia",
            "name" => "RU",
            "calling_code" => "+7",
        ],
        [
            "country" => "Rwanda",
            "name" => "RW",
            "calling_code" => "+250",
        ],
        [
            "country" => "Saint Kitts and Nevis",
            "name" => "KN",
            "calling_code" => "+1",
        ],
        [
            "country" => "Saint Lucia",
            "name" => "LC",
            "calling_code" => "+1",
        ],
        [
            "country" => "Saint Vincent and the Grenadines",
            "name" => "VC",
            "calling_code" => "+1",
        ],
        [
            "country" => "Samoa",
            "name" => "WS",
            "calling_code" => "+685",
        ],
        [
            "country" => "San Marino",
            "name" => "SM",
            "calling_code" => "+378",
        ],
        [
            "country" => "Sao Tome and Principe",
            "name" => "ST",
            "calling_code" => "+239",
        ],
        [
            "country" => "Saudi Arabia",
            "name" => "SA",
            "calling_code" => "+966",
        ],
        [
            "country" => "Senegal",
            "name" => "SN",
            "calling_code" => "+221",
        ],
        [
            "country" => "Serbia",
            "name" => "RS",
            "calling_code" => "+381",
        ],
        [
            "country" => "Seychelles",
            "name" => "SC",
            "calling_code" => "+248",
        ],
        [
            "country" => "Sierra Leone",
            "name" => "SL",
            "calling_code" => "+232",
        ],
        [
            "country" => "Singapore",
            "name" => "SG",
            "calling_code" => "+65",
        ],
        [
            "country" => "Slovakia",
            "name" => "SK",
            "calling_code" => "+421",
        ],
        [
            "country" => "Slovenia",
            "name" => "SI",
            "calling_code" => "+386",
        ],
        [
            "country" => "Solomon Islands",
            "name" => "SB",
            "calling_code" => "+677",
        ],
        [
            "country" => "Somalia",
            "name" => "SO",
            "calling_code" => "+252",
        ],
        [
            "country" => "South Africa",
            "name" => "ZA",
            "calling_code" => "+27",
        ],
        [
            "country" => "South Sudan",
            "name" => "SS",
            "calling_code" => "+211",
        ],
        [
            "country" => "Spain",
            "name" => "ES",
            "calling_code" => "+34",
        ],
        [
            "country" => "Sri Lanka",
            "name" => "LK",
            "calling_code" => "+94",
        ],
        [
            "country" => "Sudan",
            "name" => "SD",
            "calling_code" => "+249",
        ],
        [
            "country" => "Suriname",
            "name" => "SR",
            "calling_code" => "+597",
        ],
        [
            "country" => "Sweden",
            "name" => "SE",
            "calling_code" => "+46",
        ],
        [
            "country" => "Switzerland",
            "name" => "CH",
            "calling_code" => "+41",
        ],
        [
            "country" => "Syria",
            "name" => "SY",
            "calling_code" => "+963",
        ],
        [
            "country" => "Taiwan",
            "name" => "TW",
            "calling_code" => "+886",
        ],
        [
            "country" => "Tajikistan",
            "name" => "TJ",
            "calling_code" => "+992",
        ],
        [
            "country" => "Tanzania",
            "name" => "TZ",
            "calling_code" => "+255",
        ],
        [
            "country" => "Thailand",
            "name" => "TH",
            "calling_code" => "+66",
        ],
        [
            "country" => "Timor-Leste",
            "name" => "TL",
            "calling_code" => "+670",
        ],
        [
            "country" => "Togo",
            "name" => "TG",
            "calling_code" => "+228",
        ],
        [
            "country" => "Tonga",
            "name" => "TO",
            "calling_code" => "+676",
        ],
        [
            "country" => "Trinidad and Tobago",
            "name" => "TT",
            "calling_code" => "+1",
        ],
        [
            "country" => "Tunisia",
            "name" => "TN",
            "calling_code" => "+216",
        ],
        [
            "country" => "Turkey",
            "name" => "TR",
            "calling_code" => "+90",
        ],
        [
            "country" => "Turkmenistan",
            "name" => "TM",
            "calling_code" => "+993",
        ],
        [
            "country" => "Tuvalu",
            "name" => "TV",
            "calling_code" => "+688",
        ],
        [
            "country" => "Uganda",
            "name" => "UG",
            "calling_code" => "+256",
        ],
        [
            "country" => "Ukraine",
            "name" => "UA",
            "calling_code" => "+380",
        ],
        [
            "country" => "United Arab Emirates",
            "name" => "AE",
            "calling_code" => "+971",
        ],
        [
            "country" => "United Kingdom",
            "name" => "GB",
            "calling_code" => "+44",
        ],
        [
            "country" => "United States",
            "name" => "US",
            "calling_code" => "+1",
        ],
        [
            "country" => "Uruguay",
            "name" => "UY",
            "calling_code" => "+598",
        ],
        [
            "country" => "Uzbekistan",
            "name" => "UZ",
            "calling_code" => "+998",
        ],
        [
            "country" => "Vanuatu",
            "name" => "VU",
            "calling_code" => "+678",
        ],
        [
            "country" => "Vatican City",
            "name" => "VA",
            "calling_code" => "+39",
        ],
        [
            "country" => "Venezuela",
            "name" => "VE",
            "calling_code" => "+58",
        ],
        [
            "country" => "Vietnam",
            "name" => "VN",
            "calling_code" => "+84",
        ],
        [
            "country" => "Yemen",
            "name" => "YE",
            "calling_code" => "+967",
        ],
        [
            "country" => "Zambia",
            "name" => "ZM",
            "calling_code" => "+260",
        ],
        [
            "country" => "Zimbabwe",
            "name" => "ZW",
            "calling_code" => "+263",
        ],
    ];
    $countryCode = false;
    // if(is_connected()) {
    //     $details = (array) json_decode(file_get_contents("https://api.country.is/"));
    //     $countryCode = $details["country"];
    // } else {
    //     $countryCode = false;
    // }
    // // echo $countryCode; exit;
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <?=$this->include("components/head") ?>
</head>
<body>
    <header class="container py-2 py-sm-3">
        <h1 class="text-center">Digital Makers</h1>
    </header>
    <main class="container mt-5 mt-sm-4">

        
        <form class="max-w-100 mx-auto" action="<?=base_url("submit-homepage-form") ?>" onsubmit="submitForm(this)" style="width: 600px;">
            <h2 class="text-primary text-center">Get a Quote</h2>
            <div class="row row-gap-3">
                <div class="col-12">
                    <label class="form-label">Full Name</label>
                    <input type="text" name="name" class="form-control form-control-lg" placeholder="Enter Your Name" required>
                </div>
                <div class="col-12">
                    <label class="form-label">Service</label>
                    <select name="service" class="form-select form-select-lg" required>
                        <option value="default">Choose Any Service</option>
                        <option value="Web Development">Web Development (Website)</option>
                        <option value="Web Designing">Web Designing</option>
                        <option value="App Development">App Development</option>
                        <option value="Wikipedia Page">Wikipedia Page</option>
                        <option value="SEO">SEO</option>
                        <option value="Video Editing">Video Editing</option>
                        <option value="Graphic Designing">Graphic Designing</option>
                        <option value="Voice Over/Editing">Voice Over/Editing</option>
                        <option value="Social Media">Social Media</option>
                    </select>
                </div>
                <div class="col-12">
                    <label class="form-label">Country</label>
                    <select name="country" class="form-select form-select-lg" required>
                        <?php foreach($countries_data as $country): if($country["calling_code"] == "") {continue;} ?>
                            <option value="<?=$country["country"]." - ".$country["calling_code"] ?>" <?=$countryCode === $country["name"] ? "selected" : "" ?>><?=$country["country"]." (".$country["calling_code"].")" ?></option>
                        <?php endforeach; ?>
                    </select>
                </div>
                <div class="col-12">
                    <label class="form-label">Mobile</label>
                    <input type="number" name="mobile" class="form-control form-control-lg" placeholder="Enter Your Mobile no." required>
                    <input type="hidden" name="currentTime">
                </div>
                <div class="col-12">
                    <button type="submit" class="btn btn-primary btn-lg mt-2 w-100">SUBMIT</button>
                </div>
            </div>
        </form>
        
    </main>
 
    <script>
        async function submitForm(form) {
            event.preventDefault();
            const invalid = form.querySelector(".is-invalid");
            if(invalid) {
                invalid.focus();
            } else {
                const submitBtn = form.querySelector('[type="submit"]');
                submitBtn.innerHTML = "Submitting...";
                submitBtn.classList.add("pe-none");
                try {
                    const formData = new FormData(form);
                    form.currentTime.value = getCurrentTime();
                    formData.append("sheetName", "Homepage Form");
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData
                    });
                    const result = await response.text(); // Get the response from the server
                    // console.log(result); // Debugging output

                    if (response.ok) {
                        submitBtn.classList.add("btn-theme-2");
                        submitBtn.innerHTML = "Thank You!";
                        submitBtn.classList.remove("pe-none");
                    } else {
                        alert("Error submitting form, Please try after some time");
                        console.error('Failed to submit form: ', response);
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            }
        }

        function getCurrentTime() {
            let months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            let currentDate = new Date();
            let day = currentDate.getDate();
            let month = months[currentDate.getMonth()];
            let year = currentDate.getFullYear();
            let hour = currentDate.getHours();
            let minute = currentDate.getMinutes();
            let ampm = hour >= 12 ? 'PM' : 'AM';
            hour = hour % 12;
            hour = hour ? hour : 12; // Handle midnight
            minute = minute < 10 ? '0'+minute : minute; // Adding leading zero to minutes if less than 10
            let currentTime = day + " " + month + " " + year + " " + hour + ":" + minute + " " + ampm;
            return currentTime;
        }

    </script>
</body>
</html>